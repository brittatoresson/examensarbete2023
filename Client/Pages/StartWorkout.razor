@page "/timer"
@using Examensarbete.Client.Components
@using Examensarbete.Shared.Model;
@inject Microsoft.AspNetCore.Components.NavigationManager NavigationManger;
@inject Blazored.SessionStorage.ISessionStorageService sessionStorage
@inject HttpClient Http
@using Newtonsoft.Json;

    <MudPaper Class="startWorkoutContainer">

        @if (Finish)
        {
            <WorkoutSummery />
            <MudButton @onclick="SaveTodDb"> Save workout</MudButton>
        }
        else
        {
            <Timer @bind-Finish="Finish"></Timer>
            <MudButton @onclick="(() => Finish = true)"> Finish Workout (test)</MudButton>
        }
        </MudPaper>

        @code {
            public bool Finish;
            NyWorkoutModel? newWorkout = new();

            public async Task SaveTodDb()
            {
                //FUNGERAR EJ, WHYY?
                var workouts = sessionStorage.GetItemAsync<string>("Workout");
                var workout = sessionStorage.GetItemAsync<NyWorkoutModel>("Workout");

                await Http.PostAsJsonAsync("api/Ny", workout);
                NavigationManger.NavigateTo("/");
            }
        }
